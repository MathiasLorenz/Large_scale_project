Things that must be done:

- Fix non rectangular grids. Not sure if it is correct.
